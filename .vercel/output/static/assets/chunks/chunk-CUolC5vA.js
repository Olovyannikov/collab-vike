import{x as ae,l as h,m as v,j as i,at as re,au as oe,av as ne,aw as le,v as E,ax as ce,ay as ie,n as de,az as ue,C as T,p as me,w as fe,af as ge,ag as pe,r as k,aA as ye,Y as P,a6 as H,Z as J,P as f,aB as he,J as Z,K as ve,L as xe,Q as be,M as Se,S as Me,I as $e,V as je,a0 as we,X as Pe,N as x}from"./chunk-B1KjMZel.js";import{a as D}from"./chunk-DXMN5A6d.js";import{i as ke,a as Ce,b as Te,f as Oe,r as Fe}from"./chunk-C78j02Lg.js";const[Ne,$]=ae("Modal component was not found in tree");var y={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const Be={},O=h((e,t)=>{const a=v("ModalBody",Be,e),{classNames:s,className:r,style:o,styles:l,vars:c,...d}=a,n=$();return i.jsx(re,{ref:t,...n.getStyles("body",{classNames:s,style:o,styles:l,className:r}),...d})});O.classes=y;O.displayName="@mantine/core/ModalBody";const Ie={},F=h((e,t)=>{const a=v("ModalCloseButton",Ie,e),{classNames:s,className:r,style:o,styles:l,vars:c,...d}=a,n=$();return i.jsx(oe,{ref:t,...n.getStyles("close",{classNames:s,style:o,styles:l,className:r}),...d})});F.classes=y;F.displayName="@mantine/core/ModalCloseButton";const ze={},N=h((e,t)=>{const a=v("ModalContent",ze,e),{classNames:s,className:r,style:o,styles:l,vars:c,children:d,__hidden:n,...u}=a,g=$(),b=g.scrollAreaComponent||ne;return i.jsx(le,{...g.getStyles("content",{className:r,style:o,styles:l,classNames:s}),innerProps:g.getStyles("inner",{className:r,style:o,styles:l,classNames:s}),"data-full-screen":g.fullScreen||void 0,"data-modal-content":!0,"data-hidden":n||void 0,ref:t,...u,children:i.jsx(b,{style:{maxHeight:g.fullScreen?"100dvh":`calc(100dvh - (${E(g.yOffset)} * 2))`},children:d})})});N.classes=y;N.displayName="@mantine/core/ModalContent";const Re={},B=h((e,t)=>{const a=v("ModalHeader",Re,e),{classNames:s,className:r,style:o,styles:l,vars:c,...d}=a,n=$();return i.jsx(ce,{ref:t,...n.getStyles("header",{classNames:s,style:o,styles:l,className:r}),...d})});B.classes=y;B.displayName="@mantine/core/ModalHeader";const _e={},I=h((e,t)=>{const a=v("ModalOverlay",_e,e),{classNames:s,className:r,style:o,styles:l,vars:c,...d}=a,n=$();return i.jsx(ie,{ref:t,...n.getStyles("overlay",{classNames:s,style:o,styles:l,className:r}),...d})});I.classes=y;I.displayName="@mantine/core/ModalOverlay";const Qe={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:T("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},Ae=me((e,{radius:t,size:a,yOffset:s,xOffset:r})=>({root:{"--modal-radius":t===void 0?void 0:fe(t),"--modal-size":ge(a,"modal-size"),"--modal-y-offset":E(s),"--modal-x-offset":E(r)}})),z=h((e,t)=>{const a=v("ModalRoot",Qe,e),{classNames:s,className:r,style:o,styles:l,unstyled:c,vars:d,yOffset:n,scrollAreaComponent:u,radius:g,fullScreen:b,centered:m,xOffset:q,__staticSelector:Q,...A}=a,L=de({name:Q,classes:y,props:a,className:r,style:o,classNames:s,styles:l,unstyled:c,vars:d,varsResolver:Ae});return i.jsx(Ne,{value:{yOffset:n,scrollAreaComponent:u,getStyles:L,fullScreen:b},children:i.jsx(ue,{ref:t,...L("root"),"data-full-screen":b||void 0,"data-centered":m||void 0,unstyled:c,...A})})});z.classes=y;z.displayName="@mantine/core/ModalRoot";const[Ee,He]=pe();function K({children:e}){const[t,a]=k.useState([]),[s,r]=k.useState(T("modal"));return i.jsx(Ee,{value:{stack:t,addModal:(o,l)=>{a(c=>[...new Set([...c,o])]),r(c=>typeof l=="number"&&typeof c=="number"?Math.max(c,l):c)},removeModal:o=>a(l=>l.filter(c=>c!==o)),getZIndex:o=>`calc(${s} + ${t.indexOf(o)} + 1)`,currentId:t[t.length-1],maxZIndex:s},children:e})}K.displayName="@mantine/core/ModalStack";const Ve={},R=h((e,t)=>{const a=v("ModalTitle",Ve,e),{classNames:s,className:r,style:o,styles:l,vars:c,...d}=a,n=$();return i.jsx(ye,{ref:t,...n.getStyles("title",{classNames:s,style:o,styles:l,className:r}),...d})});R.classes=y;R.displayName="@mantine/core/ModalTitle";const Ze={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:T("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},p=h((e,t)=>{const{title:a,withOverlay:s,overlayProps:r,withCloseButton:o,closeButtonProps:l,children:c,radius:d,opened:n,stackId:u,zIndex:g,...b}=v("Modal",Ze,e),m=He(),q=!!a||o,Q=m&&u?{closeOnEscape:m.currentId===u,trapFocus:m.currentId===u,zIndex:m.getZIndex(u)}:{},A=s===!1?!1:u&&m?m.currentId===u:n;return k.useEffect(()=>{m&&u&&(n?m.addModal(u,g||T("modal")):m.removeModal(u))},[n,u,g]),i.jsxs(z,{ref:t,radius:d,opened:n,zIndex:m&&u?m.getZIndex(u):g,...b,...Q,children:[s&&i.jsx(I,{visible:A,transitionProps:m&&u?{duration:0}:void 0,...r}),i.jsxs(N,{radius:d,__hidden:m&&u&&n?u!==m.currentId:!1,children:[q&&i.jsxs(B,{children:[a&&i.jsx(R,{children:a}),o&&i.jsx(F,{...l})]}),i.jsx(O,{children:c})]})]})});p.classes=y;p.displayName="@mantine/core/Modal";p.Root=z;p.Overlay=I;p.Content=N;p.Body=O;p.Header=B;p.Title=R;p.CloseButton=F;p.Stack=K;function Ue(){var e=arguments.length===2?{source:arguments.length<=0?void 0:arguments[0],timeout:arguments.length<=1?void 0:arguments[1]}:arguments.length<=0?void 0:arguments[0],{source:t,timeout:a,target:s=P({name:"target",sid:"jucb8d"})}=e,r=Array.isArray(s)?s:[s];if(!H.unit(t))throw new TypeError("source must be a unit from effector");if(!r.every(c=>H.unit(c)))throw new TypeError("target must be a unit from effector");var o=qe(a),l=J(c=>{var{payload:d,milliseconds:n}=c;return new Promise(u=>{setTimeout(u,n,d)})},{name:"timerFx",sid:"-wp3hwr"});return f({and:[{source:he({and:[{milliseconds:o}],or:{name:"source",sid:"-gaikyz"}}),clock:t,fn:(c,d)=>{var{milliseconds:n}=c;return{payload:d,milliseconds:typeof n=="function"?n(d):n}},target:l}],or:{sid:"-uuqxfw"}}),f({and:[{clock:l.doneData,target:r}],or:{sid:"-uc1x9m"}}),s}function qe(e){if(H.store(e,{sid:"-tvk3f2"})||typeof e=="function"||typeof e=="number")return e;throw new TypeError(`'timeout' argument must be a function, Store, or a number. Passed "`.concat(typeof e,'"'))}const Ft=Z({sid:"-idf33f",fn:()=>ve({effect:xe(()=>({url:"/api/v1/surveys/questions"}))}),name:"getQuestionsQuery",method:"createQuery"}),_=Z({sid:"-dwzmxg",fn:()=>be({effect:Se(e=>({url:"/api/v1/surveys/answers/submit",method:Me.POST,body:e}))}),name:"submitAnswersMutation",method:"createMutation"}),Le=k.memo(({opened:e,onClose:t,onSubmit:a,loading:s})=>i.jsx(p,{opened:e,onClose:t,centered:!0,title:i.jsx($e,{fz:16,fw:"bold",children:"Завершить тестирование?"}),children:i.jsxs(je,{gap:"sm",justify:"end",children:[i.jsx(we,{size:"sm",radius:"md",variant:"outline",c:"dark.7",bd:"1px solid var(--mantine-color-dark-7)",onClick:t,children:"Отменить"}),i.jsx(Pe,{loading:s,size:"sm",radius:"md",onClick:a,children:"Завершить"})]})}));Le.displayName="SubmitTestModal";const De=P({name:"scaleFormFieldChanged",sid:"xa64nj"}),Ge=P({name:"formPageChanged",sid:"jlkrlc"}),We=P({name:"submitScaleForm",sid:"-xmifwm"}),Je=P({name:"submitModalStateChanged",sid:"-uhnbja"}),X={scaleFormFieldChanged:De,formPageChanged:Ge,submitModalStateChanged:Je,submitScaleForm:We},Ke=x(null,{name:"$preparedQuestions",sid:"tfgaqw"}),Xe=x(1,{name:"$currentPage",sid:"-bb8l64"}),Ye=x(null,{name:"$currentQuestion",sid:"-cxgb8l"}),et=x({answers:[]},{name:"$scaleForm",sid:"-3lcj8c"}),tt=x(null,{name:"$currentValue",sid:"vcprp7"}),st=x(0,{name:"$currentProgress",sid:"-1wevib"}),at=x(!1,{name:"$isSubmitModalShown",sid:"-oofaf4"}),rt=_.$pending,S={$currentPage:Xe,$currentValue:tt,$currentQuestion:Ye,$preparedQuestions:Ke,$isLoadingState:rt,$scaleForm:et,$isSubmitModalShown:at,$currentProgress:st};var ot=typeof global=="object"&&global&&global.Object===Object&&global,nt=typeof self=="object"&&self&&self.Object===Object&&self,lt=ot||nt||Function("return this")(),C=lt.Symbol,Y=Object.prototype,ct=Y.hasOwnProperty,it=Y.toString,j=C?C.toStringTag:void 0;function dt(e){var t=ct.call(e,j),a=e[j];try{e[j]=void 0;var s=!0}catch{}var r=it.call(e);return s&&(t?e[j]=a:delete e[j]),r}var ut=Object.prototype,mt=ut.toString;function ft(e){return mt.call(e)}var gt="[object Null]",pt="[object Undefined]",G=C?C.toStringTag:void 0;function yt(e){return e==null?e===void 0?pt:gt:G&&G in Object(e)?dt(e):ft(e)}function ht(e){return e!=null&&typeof e=="object"}var vt=Array.isArray,xt="[object Number]";function bt(e){return typeof e=="number"||ht(e)&&yt(e)==xt}const{$currentPage:M,$preparedQuestions:W,$currentQuestion:St,$scaleForm:w,$currentValue:ee}=S,{scaleFormFieldChanged:te,formPageChanged:U}=X;f({and:[{clock:[M,W],source:{page:M,questions:W},fn:({page:e,questions:t})=>t?t[e-1]:null,target:St}],or:{sid:"-pqbba2"}});f({and:[{clock:te,source:w,fn:(e,t)=>(e.answers[t.index]=t,{...e}),target:w}],or:{sid:"-p7mb3s"}});const se=Z({sid:"-1eech",fn:()=>Ue(te,1e3),name:"delayed",method:"delay"});f({and:[{clock:se,source:M,filter:(e,t)=>!(t.isMultiple||t.isSingle),fn:e=>e+1,target:U}],or:{sid:"-ooxaxi"}});f({and:[{clock:se,source:{form:w,page:M},filter:(e,t)=>!(t.isMultiple||t.isSingle),fn:({form:e,page:t})=>{const a=t-1;return e.answers&&e.answers.length>0&&"value"in e.answers[a].answer&&e.answers[a].answer.value?e.answers[a].answer.value:null},target:ee}],or:{sid:"-o8z9q1"}});f({and:[{clock:[w,U],source:{form:w,page:M},fn:({form:{answers:e},page:t},a)=>{var r;const s=(bt(a)?a:t)-1;return(r=e[s])!=null&&r.answer?e&&e[s].answer&&vt(e[s].answer)||e&&e.length>0&&e[s].isSingle?e[s].answer:e&&e.length>0&&"value"in e[s].answer?e[s].answer.value:null:null},target:ee}],or:{sid:"-n9sfqx"}});f({and:[{clock:U,fn:e=>(window.scrollTo(0,0),e),target:M}],or:{sid:"-lwaycf"}});function Mt(e,t){const a=`[${t}(url)] Invalid URL ${e}`;return D(ke(e),a),e.startsWith(location.origin)&&(e=e.slice(location.origin.length)),D(e.startsWith("/")||Ce(e),a),e}Te();async function $t(e,{keepScrollPosition:t=!1,overwriteLastHistoryEntry:a=!1,pageContext:s}={}){Mt(e,"navigate"),await Oe,await Fe({scrollTarget:{preserveScroll:t},urlOriginal:e,overwriteLastHistoryEntry:a,isBackwardNavigation:!1,pageContextInitClient:s})}const{$scaleForm:jt,$isSubmitModalShown:V}=S,{submitScaleForm:wt,submitModalStateChanged:Pt}=X,kt=J(async()=>{await $t("/free-report")},{name:"redirectToFreeReportPageFx",sid:"-rjfn83"});f({and:[{clock:Pt,source:V,fn:e=>!e,target:V}],or:{sid:"63vz2f"}});f({and:[{clock:wt,source:jt,target:_.start}],or:{sid:"6ja7oj"}});f({and:[{clock:_.finished.success,fn:()=>!1,target:V}],or:{sid:"6mkz8p"}});f({and:[{clock:_.finished.success,filter:()=>!(window!=null&&window.location.origin.includes("free-report")),target:kt}],or:{sid:"71ff9g"}});f({and:[{clock:S.$scaleForm,source:{questions:S.$preparedQuestions,form:S.$scaleForm},fn:({questions:e,form:{answers:t}})=>Number((t.length/((e==null?void 0:e.length)??0)*100).toFixed(0)),target:S.$currentProgress}],or:{sid:"-hdmfhh"}});export{Le as S,S as T,X as a,Ue as d,Ft as g,vt as i};
