import{Q as $,S as A,W as z,aE as B,V as G,a3 as j,a4 as q,a9 as Z,X as d,a5 as _,Y as ee,a0 as te,ay as C}from"./chunk-Bh0Djd6l.js";var J=new Map,K=e=>([t],y)=>e(y,t),H=$();function re(e){var{adapter:t,store:y,source:a=y,target:p=y,clock:x=a,done:v,fail:c=H,finally:g,pickup:u,context:k,key:S,keyPrefix:h="",contract:E}=e;if(!t)throw Error("Adapter is not defined");if(!a)throw Error("Store or source is not defined");if(!p)throw Error("Target is not defined");if(!S&&a.shortName===a.id)throw Error("Key or name is not defined");if(a===p&&!A.store(a))throw Error("Source must be different from target");e.def===void 0&&A.store(a)&&(e.def=a.defaultState);var s="factory"in t?t(e):t,w=S||a.shortName,P=function(l,m){var o=J.get(l);o===void 0&&(o=new Map,J.set(l,o));var f=o.get(m);return f!==void 0||(f=z(null,{serialize:"ignore"}),o.set(m,f)),f}(s.keyArea||s,h+w),M=B(),N=()=>_(M),T=l=>({status:m="fail",params:o,result:f,error:b})=>m==="done"?{status:m,key:w,keyPrefix:h,operation:l,value:l==="get"?f:o}:{status:m,key:w,keyPrefix:h,operation:l,value:typeof o=="function"?void 0:o,error:b};return G(M,()=>{var l=z([],{serialize:"ignore"}),m=s(h+w,r=>{F(r)}),o=j({source:l,effect:K(m.get)}),f=j({source:l,effect:K(m.set)}),b=q((r=>n=>!r||n===void 0||("isData"in r?r.isData(n):r(n))?n:(()=>{throw"getErrorMessages"in r?r.getErrorMessages(n):void 0})())(E)),D=$(),R=$(),F=o;l.updates.watch(()=>{F=Z(o,{safe:!0})}),d({clock:x,source:a,target:R}),d({clock:R,source:P,filter:(r,n)=>n!==r,fn:(r,n)=>n,target:f}),d({clock:[o.doneData,d(f,f.done)],filter:r=>r!==void 0,target:P}),d({clock:[o.doneData,P],target:b}),d({clock:b.doneData,filter:r=>r!==void 0,target:p}),d({clock:[o.finally.map(T("get")),f.finally.map(T("set")),b.fail.map(T("validate"))],target:D}),g&&d({clock:D,target:g}),v&&d({clock:D,filter:({status:r})=>r==="done",fn:({key:r,keyPrefix:n,operation:U,value:I})=>({key:r,keyPrefix:n,operation:U,value:I}),target:v}),d({clock:D,filter:({status:r})=>r==="fail",fn:({key:r,keyPrefix:n,operation:U,error:I,value:Y})=>({key:r,keyPrefix:n,operation:U,error:I,value:Y}),target:c}),k&&l.on(k,([r],n)=>[n===void 0?r:n]),u?(d({clock:u,fn:()=>{},target:o}),l.on(u,([r],n)=>[n===void 0?r:n])):o()}),N.unsubscribe=N}H.watch(e=>console.error(e.error));function Q({keyArea:e=""}={}){var t=()=>({get(){},set(){}});return t.keyArea=e,t.noop=!0,t}Q.factory=!0;function W({storage:e,sync:t=!1,serialize:y=JSON.stringify,deserialize:a=JSON.parse,timeout:p,def:x}){var v=(c,g)=>{var u,k,S,h=()=>S.setItem(c,y(k)),E=s=>{u=clearTimeout(u),s&&h(),typeof removeEventListener<"u"&&removeEventListener("beforeunload",E)};return t&&typeof addEventListener<"u"&&addEventListener("storage",s=>{s.storageArea===e()&&(s.key===c&&g(t==="force"?void 0:s.newValue),s.key===null&&g(null))}),{get(s){E();var w=s!==void 0?s:e().getItem(c);return w===null?x!==void 0?x:s:a(w)},set(s){k=s,S=e(),p===void 0?h():u||(u=setTimeout(E,p,1),typeof addEventListener<"u"&&addEventListener("beforeunload",E))}}};try{v.keyArea=e()}catch{}return v}W.factory=!0;function X(e){return function(){try{return typeof localStorage<"u"}catch{return!0}}()?W({storage:()=>localStorage,sync:!0,...e}):Q({keyArea:"local"})}function ae(e){return t=>re({adapter:X,...e,...t})}X.factory=!0;var ne=ae();function oe(){var e=arguments.length===2?{source:arguments.length<=0?void 0:arguments[0],timeout:arguments.length<=1?void 0:arguments[1]}:arguments.length<=0?void 0:arguments[0],{source:t,timeout:y,target:a=$({name:"target",sid:"jucb8d"})}=e,p=Array.isArray(a)?a:[a];if(!A.unit(t))throw new TypeError("source must be a unit from effector");if(!p.every(c=>A.unit(c)))throw new TypeError("target must be a unit from effector");var x=ie(y),v=q(c=>{var{payload:g,milliseconds:u}=c;return new Promise(k=>{setTimeout(k,u,g)})},{name:"timerFx",sid:"-wp3hwr"});return d({and:[{source:ee({and:[{milliseconds:x}],or:{name:"source",sid:"-gaikyz"}}),clock:t,fn:(c,g)=>{var{milliseconds:u}=c;return{payload:g,milliseconds:typeof u=="function"?u(g):u}},target:v}],or:{sid:"-uuqxfw"}}),d({and:[{clock:v.doneData,target:p}],or:{sid:"-uc1x9m"}}),a}function ie(e){if(A.store(e,{sid:"-tvk3f2"})||typeof e=="function"||typeof e=="number")return e;throw new TypeError(`'timeout' argument must be a function, Store, or a number. Passed "`.concat(typeof e,'"'))}const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function se(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}let L;const ue=new Uint8Array(16);function de(){if(!L){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");L=crypto.getRandomValues.bind(crypto)}return L(ue)}const ce=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),O={randomUUID:ce};function le(e,t,y){if(O.randomUUID&&!t&&!e)return O.randomUUID();e=e||{};const a=e.random||(e.rng||de)();return a[6]=a[6]&15|64,a[8]=a[8]&63|128,se(a)}const V=z("",{name:"$uuid",sid:"1mpkgt"}),fe=te({sid:"-9ea67c",fn:()=>oe(C.appStarted,300),name:"delayedAppStarted",method:"delay"});ne({store:V,pickup:C.appStarted});d({and:[{clock:fe,source:V,fn:e=>e.length>0?e:le(),target:V}],or:{sid:"-xx6i4t"}});export{V as $,ne as a,oe as d};
