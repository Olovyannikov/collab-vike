import{l as ne,m as v,n as x,j as n,aq as le,ar as ce,as as de,at as ie,s as z,au as ue,av as me,y as fe,aw as pe,x as C,C as ge,D as ye,P as he,ai as be,r as O,ax as ve,g as c,Z as V,a0 as xe,Q as T,W as M,X as p,ay as Me,a4 as Y,aa as Se,ao as L,az as q}from"./chunk-DaWK8C2F.js";import{b as $e,I as je,f as we,j as Pe,c as Oe,H as Fe,a as ke,B as Ce,M as Te,n as Ne}from"./chunk-BxHTwqsj.js";import"./chunk-C78j02Lg.js";const[Ee,j]=ne("Modal component was not found in tree");var b={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const Ie={},N=v((e,t)=>{const a=x("ModalBody",Ie,e),{classNames:s,className:r,style:o,styles:l,vars:u,...m}=a,d=j();return n.jsx(le,{ref:t,...d.getStyles("body",{classNames:s,style:o,styles:l,className:r}),...m})});N.classes=b;N.displayName="@mantine/core/ModalBody";const Be={},E=v((e,t)=>{const a=x("ModalCloseButton",Be,e),{classNames:s,className:r,style:o,styles:l,vars:u,...m}=a,d=j();return n.jsx(ce,{ref:t,...d.getStyles("close",{classNames:s,style:o,styles:l,className:r}),...m})});E.classes=b;E.displayName="@mantine/core/ModalCloseButton";const He={},I=v((e,t)=>{const a=x("ModalContent",He,e),{classNames:s,className:r,style:o,styles:l,vars:u,children:m,__hidden:d,...i}=a,g=j(),S=g.scrollAreaComponent||de;return n.jsx(ie,{...g.getStyles("content",{className:r,style:o,styles:l,classNames:s}),innerProps:g.getStyles("inner",{className:r,style:o,styles:l,classNames:s}),"data-full-screen":g.fullScreen||void 0,"data-modal-content":!0,"data-hidden":d||void 0,ref:t,...i,children:n.jsx(S,{style:{maxHeight:g.fullScreen?"100dvh":`calc(100dvh - (${z(g.yOffset)} * 2))`},children:m})})});I.classes=b;I.displayName="@mantine/core/ModalContent";const Ae={},B=v((e,t)=>{const a=x("ModalHeader",Ae,e),{classNames:s,className:r,style:o,styles:l,vars:u,...m}=a,d=j();return n.jsx(ue,{ref:t,...d.getStyles("header",{classNames:s,style:o,styles:l,className:r}),...m})});B.classes=b;B.displayName="@mantine/core/ModalHeader";const _e={},H=v((e,t)=>{const a=x("ModalOverlay",_e,e),{classNames:s,className:r,style:o,styles:l,vars:u,...m}=a,d=j();return n.jsx(me,{ref:t,...d.getStyles("overlay",{classNames:s,style:o,styles:l,className:r}),...m})});H.classes=b;H.displayName="@mantine/core/ModalOverlay";const Qe={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:C("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},Ze=ge((e,{radius:t,size:a,yOffset:s,xOffset:r})=>({root:{"--modal-radius":t===void 0?void 0:ye(t),"--modal-size":he(a,"modal-size"),"--modal-y-offset":z(s),"--modal-x-offset":z(r)}})),A=v((e,t)=>{const a=x("ModalRoot",Qe,e),{classNames:s,className:r,style:o,styles:l,unstyled:u,vars:m,yOffset:d,scrollAreaComponent:i,radius:g,fullScreen:S,centered:f,xOffset:G,__staticSelector:Q,...Z}=a,U=fe({name:Q,classes:b,props:a,className:r,style:o,classNames:s,styles:l,unstyled:u,vars:m,varsResolver:Ze});return n.jsx(Ee,{value:{yOffset:d,scrollAreaComponent:i,getStyles:U,fullScreen:S},children:n.jsx(pe,{ref:t,...U("root"),"data-full-screen":S||void 0,"data-centered":f||void 0,unstyled:u,...Z})})});A.classes=b;A.displayName="@mantine/core/ModalRoot";const[ze,Re]=be();function ee({children:e}){const[t,a]=O.useState([]),[s,r]=O.useState(C("modal"));return n.jsx(ze,{value:{stack:t,addModal:(o,l)=>{a(u=>[...new Set([...u,o])]),r(u=>typeof l=="number"&&typeof u=="number"?Math.max(u,l):u)},removeModal:o=>a(l=>l.filter(u=>u!==o)),getZIndex:o=>`calc(${s} + ${t.indexOf(o)} + 1)`,currentId:t[t.length-1],maxZIndex:s},children:e})}ee.displayName="@mantine/core/ModalStack";const Ve={},_=v((e,t)=>{const a=x("ModalTitle",Ve,e),{classNames:s,className:r,style:o,styles:l,vars:u,...m}=a,d=j();return n.jsx(ve,{ref:t,...d.getStyles("title",{classNames:s,style:o,styles:l,className:r}),...m})});_.classes=b;_.displayName="@mantine/core/ModalTitle";const Le={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:C("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},y=v((e,t)=>{const{title:a,withOverlay:s,overlayProps:r,withCloseButton:o,closeButtonProps:l,children:u,radius:m,opened:d,stackId:i,zIndex:g,...S}=x("Modal",Le,e),f=Re(),G=!!a||o,Q=f&&i?{closeOnEscape:f.currentId===i,trapFocus:f.currentId===i,zIndex:f.getZIndex(i)}:{},Z=s===!1?!1:i&&f?f.currentId===i:d;return O.useEffect(()=>{f&&i&&(d?f.addModal(i,g||C("modal")):f.removeModal(i))},[d,i,g]),n.jsxs(A,{ref:t,radius:m,opened:d,zIndex:f&&i?f.getZIndex(i):g,...S,...Q,children:[s&&n.jsx(H,{visible:Z,transitionProps:f&&i?{duration:0}:void 0,...r}),n.jsxs(I,{radius:m,__hidden:f&&i&&d?i!==f.currentId:!1,children:[G&&n.jsxs(B,{children:[a&&n.jsx(_,{children:a}),o&&n.jsx(E,{...l})]}),n.jsx(N,{children:u})]})]})});y.classes=b;y.displayName="@mantine/core/Modal";y.Root=A;y.Overlay=H;y.Content=I;y.Body=N;y.Header=B;y.Title=_;y.CloseButton=E;y.Stack=ee;const qe=new Map([["bold",c.createElement(c.Fragment,null,c.createElement("path",{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"}))],["duotone",c.createElement(c.Fragment,null,c.createElement("path",{d:"M112,56V200L40,128Z",opacity:"0.2"}),c.createElement("path",{d:"M216,120H120V56a8,8,0,0,0-13.66-5.66l-72,72a8,8,0,0,0,0,11.32l72,72A8,8,0,0,0,120,200V136h96a8,8,0,0,0,0-16ZM104,180.69,51.31,128,104,75.31Z"}))],["fill",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H120v64a8,8,0,0,1-13.66,5.66l-72-72a8,8,0,0,1,0-11.32l72-72A8,8,0,0,1,120,56v64h96A8,8,0,0,1,224,128Z"}))],["light",c.createElement(c.Fragment,null,c.createElement("path",{d:"M222,128a6,6,0,0,1-6,6H54.49l61.75,61.76a6,6,0,1,1-8.48,8.48l-72-72a6,6,0,0,1,0-8.48l72-72a6,6,0,0,1,8.48,8.48L54.49,122H216A6,6,0,0,1,222,128Z"}))],["regular",c.createElement(c.Fragment,null,c.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"}))],["thin",c.createElement(c.Fragment,null,c.createElement("path",{d:"M220,128a4,4,0,0,1-4,4H49.66l65.17,65.17a4,4,0,0,1-5.66,5.66l-72-72a4,4,0,0,1,0-5.66l72-72a4,4,0,0,1,5.66,5.66L49.66,124H216A4,4,0,0,1,220,128Z"}))]]);var De=Object.defineProperty,Ge=Object.defineProperties,Ue=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,We=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,X=(e,t,a)=>t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Je=(e,t)=>{for(var a in t||(t={}))We.call(t,a)&&X(e,a,t[a]);if(W)for(var a of W(t))Xe.call(t,a)&&X(e,a,t[a]);return e},Ke=(e,t)=>Ge(e,Ue(t));const Ye=O.forwardRef((e,t)=>c.createElement($e,Ke(Je({ref:t},e),{weights:qe})));Ye.displayName="ArrowLeft";var et=typeof global=="object"&&global&&global.Object===Object&&global,tt=typeof self=="object"&&self&&self.Object===Object&&self,at=et||tt||Function("return this")(),k=at.Symbol,te=Object.prototype,st=te.hasOwnProperty,rt=te.toString,P=k?k.toStringTag:void 0;function ot(e){var t=st.call(e,P),a=e[P];try{e[P]=void 0;var s=!0}catch{}var r=rt.call(e);return s&&(t?e[P]=a:delete e[P]),r}var nt=Object.prototype,lt=nt.toString;function ct(e){return lt.call(e)}var dt="[object Null]",it="[object Undefined]",J=k?k.toStringTag:void 0;function ut(e){return e==null?e===void 0?it:dt:J&&J in Object(e)?ot(e):ct(e)}function mt(e){return e!=null&&typeof e=="object"}var ft=Array.isArray,pt="[object Number]";function gt(e){return typeof e=="number"||mt(e)&&ut(e)==pt}const Qt=V({sid:"-idf33f",fn:()=>je({effect:we(()=>({url:"/api/v1/surveys/questions"}))}),name:"getQuestionsQuery",method:"createQuery"}),w=V({sid:"-dwzmxg",fn:()=>Pe({effect:Oe(e=>({url:"/api/v1/surveys/answers/submit",method:Fe.POST,body:e}))}),name:"submitAnswersMutation",method:"createMutation"}),yt=O.memo(({opened:e,onClose:t,onSubmit:a,loading:s})=>n.jsx(y,{opened:e,onClose:t,centered:!0,title:n.jsx(ke,{fz:16,fw:"bold",children:"Завершить тестирование?"}),children:n.jsxs(xe,{gap:"sm",justify:"end",children:[n.jsx(Ce,{size:"sm",radius:"md",variant:"outline",c:"dark.7",bd:"1px solid var(--mantine-color-dark-7)",onClick:t,children:"Отменить"}),n.jsx(Te,{loading:s,size:"sm",radius:"md",onClick:a,children:"Завершить"})]})}));yt.displayName="SubmitTestModal";const ht=T({name:"scaleFormFieldChanged",sid:"xa64nj"}),bt=T({name:"formPageChanged",sid:"jlkrlc"}),vt=T({name:"submitScaleForm",sid:"-xmifwm"}),xt=T({name:"submitModalStateChanged",sid:"-uhnbja"}),ae={scaleFormFieldChanged:ht,formPageChanged:bt,submitModalStateChanged:xt,submitScaleForm:vt},Mt=M(null,{name:"$surveyId",sid:"phgjfd"}),St=M(null,{name:"$preparedQuestions",sid:"twhx53"}),$t=M(1,{name:"$currentPage",sid:"v6oeh4"}),jt=M(null,{name:"$currentQuestion",sid:"-cgeoue"}),wt=M({answers:[]},{name:"$scaleForm",sid:"-34awu5"}),Pt=M(null,{name:"$currentValue",sid:"vtre3e"}),Ot=M(0,{name:"$currentProgress",sid:"-1fd944"}),Ft=M(!1,{name:"$isSubmitModalShown",sid:"-o7do0x"}),kt=w.$pending,h={$currentPage:$t,$currentValue:Pt,$currentQuestion:jt,$preparedQuestions:St,$isLoadingState:kt,$scaleForm:wt,$isSubmitModalShown:Ft,$currentProgress:Ot,$surveyId:Mt},{$currentPage:$,$preparedQuestions:K,$currentQuestion:Ct,$scaleForm:F,$currentValue:se}=h,{scaleFormFieldChanged:re,formPageChanged:D}=ae;p({and:[{clock:[$,K],source:{page:$,questions:K},fn:({page:e,questions:t})=>t?t[e-1]:null,target:Ct}],or:{sid:"-pqbba2"}});p({and:[{clock:re,source:F,fn:(e,t)=>(e.answers[t.index]=t,{...e}),target:F}],or:{sid:"-p7mb3s"}});const oe=V({sid:"-1eech",fn:()=>Me(re,1e3),name:"delayed",method:"delay"});p({and:[{clock:oe,source:$,filter:(e,t)=>!(t.isMultiple||t.isSingle),fn:e=>e+1,target:D}],or:{sid:"-ooxaxi"}});p({and:[{clock:oe,source:{form:F,page:$},filter:(e,t)=>!(t.isMultiple||t.isSingle),fn:({form:e,page:t})=>{const a=t-1;return e.answers&&e.answers.length>0&&"value"in e.answers[a].answer&&e.answers[a].answer.value?e.answers[a].answer.value:null},target:se}],or:{sid:"-o8z9q1"}});p({and:[{clock:[F,D],source:{form:F,page:$},fn:({form:{answers:e},page:t},a)=>{var r;const s=(gt(a)?a:t)-1;return(r=e[s])!=null&&r.answer?e&&e[s].answer&&ft(e[s].answer)||e&&e.length>0&&e[s].isSingle?e[s].answer:e&&e.length>0&&"value"in e[s].answer?e[s].answer.value:null:null},target:se}],or:{sid:"-n9sfqx"}});p({and:[{clock:D,fn:e=>(window.scrollTo(0,0),e),target:$}],or:{sid:"-lwaycf"}});const{$scaleForm:Tt,$isSubmitModalShown:R}=h,{submitScaleForm:Nt,submitModalStateChanged:Et}=ae,It=Y(async()=>{await Ne("/free-report")},{name:"redirectToFreeReportPageFx",sid:"-r2e0tw"}),Bt=Y(async e=>{Se.show({color:"red",title:"Ошибка!",message:e})},{name:"showSubmitErrorFx",sid:"icm0c9"});p({and:[{clock:Et,source:R,fn:e=>!e,target:R}],or:{sid:"6kdsv9"}});p({and:[{clock:Nt,source:Tt,target:w.start}],or:{sid:"6zs1hd"}});p({and:[{clock:w.finished.success,fn:()=>!1,target:R}],or:{sid:"732t1j"}});p({and:[{clock:w.finished.success,filter:()=>!(window!=null&&window.location.origin.includes("free-report")),fn:({result:e})=>e.id,target:h.$surveyId}],or:{sid:"7hx92a"}});p({and:[{clock:w.finished.success,filter:()=>!(window!=null&&window.location.origin.includes("free-report")),target:It}],or:{sid:"7xbhoe"}});p({and:[{clock:w.finished.failure,fn:e=>e.error.message,target:Bt}],or:{sid:"80m98k"}});p({and:[{clock:h.$scaleForm,source:{questions:h.$preparedQuestions,form:h.$scaleForm},fn:({questions:e,form:{answers:t}})=>Number((t.length/((e==null?void 0:e.length)??0)*100).toFixed(0)),target:h.$currentProgress}],or:{sid:"-hdmfhh"}});L({store:h.$currentPage,pickup:q.appStarted});L({store:h.$scaleForm,pickup:q.appStarted});L({store:h.$currentProgress,pickup:q.appStarted});export{Ye as I,yt as S,h as T,ae as a,Qt as g,ft as i};
