import{H as $,Y as A,X as z,aH as Q,al as W,am as H,C as J,aq as Z,D as d,an as _,v as ee,A as te,aG as K}from"./chunk-CPOvvIjG.js";var j=new Map,q=e=>([t],y)=>e(y,t),O=$();function re(e){var{adapter:t,store:y,source:n=y,target:m=y,clock:x=n,done:v,fail:c=O,finally:g,pickup:u,context:k,key:S,keyPrefix:h="",contract:E}=e;if(!t)throw Error("Adapter is not defined");if(!n)throw Error("Store or source is not defined");if(!m)throw Error("Target is not defined");if(!S&&n.shortName===n.id)throw Error("Key or name is not defined");if(n===m&&!A.store(n))throw Error("Source must be different from target");e.def===void 0&&A.store(n)&&(e.def=n.defaultState);var s="factory"in t?t(e):t,w=S||n.shortName,P=function(l,p){var o=j.get(l);o===void 0&&(o=new Map,j.set(l,o));var f=o.get(p);return f!==void 0||(f=z(null,{serialize:"ignore"}),o.set(p,f)),f}(s.keyArea||s,h+w),N=Q(),V=()=>_(N),T=l=>({status:p="fail",params:o,result:f,error:b})=>p==="done"?{status:p,key:w,keyPrefix:h,operation:l,value:l==="get"?f:o}:{status:p,key:w,keyPrefix:h,operation:l,value:typeof o=="function"?void 0:o,error:b};return W(N,()=>{var l=z([],{serialize:"ignore"}),p=s(h+w,r=>{F(r)}),o=H({source:l,effect:q(p.get)}),f=H({source:l,effect:q(p.set)}),b=J((r=>a=>!r||a===void 0||("isData"in r?r.isData(a):r(a))?a:(()=>{throw"getErrorMessages"in r?r.getErrorMessages(a):void 0})())(E)),D=$(),R=$(),F=o;l.updates.watch(()=>{F=Z(o,{safe:!0})}),d({clock:x,source:n,target:R}),d({clock:R,source:P,filter:(r,a)=>a!==r,fn:(r,a)=>a,target:f}),d({clock:[o.doneData,d(f,f.done)],filter:r=>r!==void 0,target:P}),d({clock:[o.doneData,P],target:b}),d({clock:b.doneData,filter:r=>r!==void 0,target:m}),d({clock:[o.finally.map(T("get")),f.finally.map(T("set")),b.fail.map(T("validate"))],target:D}),g&&d({clock:D,target:g}),v&&d({clock:D,filter:({status:r})=>r==="done",fn:({key:r,keyPrefix:a,operation:U,value:I})=>({key:r,keyPrefix:a,operation:U,value:I}),target:v}),d({clock:D,filter:({status:r})=>r==="fail",fn:({key:r,keyPrefix:a,operation:U,error:I,value:B})=>({key:r,keyPrefix:a,operation:U,error:I,value:B}),target:c}),k&&l.on(k,([r],a)=>[a===void 0?r:a]),u?(d({clock:u,fn:()=>{},target:o}),l.on(u,([r],a)=>[a===void 0?r:a])):o()}),V.unsubscribe=V}O.watch(e=>console.error(e.error));function G({keyArea:e=""}={}){var t=()=>({get(){},set(){}});return t.keyArea=e,t.noop=!0,t}G.factory=!0;function X({storage:e,sync:t=!1,serialize:y=JSON.stringify,deserialize:n=JSON.parse,timeout:m,def:x}){var v=(c,g)=>{var u,k,S,h=()=>S.setItem(c,y(k)),E=s=>{u=clearTimeout(u),s&&h(),typeof removeEventListener<"u"&&removeEventListener("beforeunload",E)};return t&&typeof addEventListener<"u"&&addEventListener("storage",s=>{s.storageArea===e()&&(s.key===c&&g(t==="force"?void 0:s.newValue),s.key===null&&g(null))}),{get(s){E();var w=s!==void 0?s:e().getItem(c);return w===null?x!==void 0?x:s:n(w)},set(s){k=s,S=e(),m===void 0?h():u||(u=setTimeout(E,m,1),typeof addEventListener<"u"&&addEventListener("beforeunload",E))}}};try{v.keyArea=e()}catch{}return v}X.factory=!0;function Y(e){return function(){try{return typeof localStorage<"u"}catch{return!0}}()?X({storage:()=>localStorage,sync:!0,...e}):G({keyArea:"local"})}function ne(e){return t=>re({adapter:Y,...e,...t})}Y.factory=!0;var ae=ne();function oe(){var e=arguments.length===2?{source:arguments.length<=0?void 0:arguments[0],timeout:arguments.length<=1?void 0:arguments[1]}:arguments.length<=0?void 0:arguments[0],{source:t,timeout:y,target:n=$({name:"target",sid:"jucb8d"})}=e,m=Array.isArray(n)?n:[n];if(!A.unit(t))throw new TypeError("source must be a unit from effector");if(!m.every(c=>A.unit(c)))throw new TypeError("target must be a unit from effector");var x=ie(y),v=J(c=>{var{payload:g,milliseconds:u}=c;return new Promise(k=>{setTimeout(k,u,g)})},{name:"timerFx",sid:"-wp3hwr"});return d({and:[{source:ee({and:[{milliseconds:x}],or:{name:"source",sid:"-gaikyz"}}),clock:t,fn:(c,g)=>{var{milliseconds:u}=c;return{payload:g,milliseconds:typeof u=="function"?u(g):u}},target:v}],or:{sid:"-uuqxfw"}}),d({and:[{clock:v.doneData,target:m}],or:{sid:"-uc1x9m"}}),n}function ie(e){if(A.store(e,{sid:"-tvk3f2"})||typeof e=="function"||typeof e=="number")return e;throw new TypeError(`'timeout' argument must be a function, Store, or a number. Passed "`.concat(typeof e,'"'))}const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function se(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}let L;const ue=new Uint8Array(16);function de(){if(!L){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");L=crypto.getRandomValues.bind(crypto)}return L(ue)}const ce=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),C={randomUUID:ce};function le(e,t,y){if(C.randomUUID&&!t&&!e)return C.randomUUID();e=e||{};const n=e.random||(e.rng||de)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,se(n)}const M=z("",{name:"$uuid",sid:"1mpkgt"}),fe=te({sid:"-9ea67c",fn:()=>oe(K.appStarted,300),name:"delayedAppStarted",method:"delay"});ae({store:M,pickup:K.appStarted});d({and:[{clock:fe,source:M,fn:e=>e.length>0?e:le(),target:M}],or:{sid:"-xx6i4t"}});export{M as $,ae as a,oe as d};
