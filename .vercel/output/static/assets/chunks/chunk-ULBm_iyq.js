import{C as E,H as b,X as T,v as N,aK as J,D as f,am as L,aq as $e,Y as U,al as qe,aH as we,aL as ze}from"./chunk-CPOvvIjG.js";const _e={isData:e=>!0,getErrorMessages:()=>[]};function H({field:e}){let t;if(e===void 0)t=T(r=>null,{serialize:"ignore",name:"ff.$target/undefined",sid:"ff.$target/undefined"});else if(U.store(e))t=N(e,r=>a=>r??null);else if(e!=null&&e.source&&e!=null&&e.fn){const r=e;t=N(r.source,a=>s=>r.fn(s,a)??null)}else if(typeof e=="function"){const r=e;t=T(a=>r(a)??null,{serialize:"ignore",name:"ff.$target/callbackField",sid:"ff.$target/$callbackField"})}else{const r=e;t=T(a=>r??null,{serialize:"ignore",name:"ff.$target/valueField",sid:"ff.$target/$valueField"})}return t}function Me(e){let t;if(e===void 0)t=E(async r=>null);else if(U.store(e))t=L({source:e,async effect(r,a){return r}});else if(e.source&&e.fn){const r=e;t=L({source:r.source,async effect(a,s){return r.fn(s,a)}})}else if(typeof e=="function"){const r=e;t=E(async a=>r(a))}else{const r=e;t=E(async a=>r)}return t}function ae(e){return e?U.store(e)?e:T(e,{serialize:"ignore",name:"ff.$target/valueField",sid:"ff.$target/$valueField"}):T(null,{serialize:"ignore",name:"ff.$target/undefined",sid:"ff.$target/$undefined"})}function He({clock:e,timeout:t,target:r=b()}){const a=E(({payload:s,milliseconds:i})=>new Promise(o=>{setTimeout(o,i,s)}));return f({source:ae(t),clock:e,fn:(s,i)=>({payload:i,milliseconds:s}),target:a}),f({clock:a.doneData,target:r}),r}function Ue(e,t){let r=[],a=()=>!1;Array.isArray(e)?(r=e,a=t):Array.isArray(e.stores)&&(r=e.stores,a=e.predicate);let s;Qe(a)?s=a:U.store(a)?s=a.map(o=>c=>o===c):s=o=>o===a;const i=N(r);return N(s,i,(o,c)=>c.every(o))}function Qe(e){return typeof e=="function"}function Z(e){return e.map(t=>!t)}function Ve(...e){return Ue({predicate:!0,stores:e})}function Be({clock:e,until:t}){const r=b(),a=T(!1,{serialize:"ignore",name:"ff.$fired",sid:"ff.$fired"}).on(r,()=>!0).on(e,()=>!1);return f({clock:[e,t],source:e,filter:Ve(t,Z(a)),target:r}),r}function X(e){if(e==="ignore")return"ignore"}const le=E(()=>Date.now());function Je({clock:e}){const t=T(Date.now(),{name:"ff.$time",sid:"ff.$time"});return f({clock:e,fn:()=>{},target:le}),f({clock:le.doneData,target:t}),t}function w(e){return e.map(t=>t,{skipVoid:!1})}function We(){const e={resolve:()=>{},reject:()=>{},promise:null};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e.promise.catch(()=>{}),e}function ee(e,t){try{if(e===t||Number.isNaN(e)&&Number.isNaN(t))return!0;const r=ue(e),a=ue(t);if(r!==a)return!1;if(r==="pure-object"){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t).length;if(s.length!==i)return!1;for(let o=0,c=s.length;o<c;o++){const h=s[o];if(!Object.prototype.hasOwnProperty.call(t,s[o]))return!1;const $=e[h],n=t[h];if($===e||n===t||$===t||n===e)return $===n;if(!ee($,n))return!1}return!0}else if(r==="array"){if(e.length===t.length)for(let s=0;s<e.length;s++){const i=e[s],o=t[s];if(i===e||o===t||i===t||o===e)return i===o;if(!ee(i,o))return!1}else return!1;return!0}else if(r==="object"&&e.valueOf&&t.valueOf)return e.valueOf()===t.valueOf()}catch{}return!1}function Ke(e){if(Array.isArray(e))return!0;const t=e.length;return typeof t=="number"&&t>-1?t?0 in e&&t-1 in e:!0:!1}function ue(e){const t=typeof e;return t==="object"?e===null?"null":Ke(e)?"array":e.constructor===Object||Object.getPrototypeOf(e)===null?"pure-object":"object":t}function fe(e){return t=>t[e]}function be(){var e,t;return((t=(e=we({regional:!0}).family.owners[0])==null?void 0:e.meta)==null?void 0:t.name)??void 0}const Ge="INVALID_DATA",ke="ABORT",Xe="HTTP",Ye="NETWORK";function te(e){return{...e,errorType:Ge,explanation:"Response was considered as invalid against a given contract"}}function Ze(){return{errorType:ke,explanation:"Request was cancelled due to concurrency policy"}}function et(e){return{...e,errorType:Xe,explanation:"Request was finished with unsuccessful HTTP code"}}function tt(e){return{...e,errorType:Ye,explanation:"Request was failed due to network problems"}}function rt(e){return E({handler:({result:t})=>{if(!e.isData(t))throw te({validationErrors:e.getErrorMessages(t),response:t});return t},sid:"ff.applyContractFx"})}function at(e){return!!(e===!0||Array.isArray(e)&&e.length===0||typeof e=="string"&&e.length===0)}function pe(e){return e===!0?[]:e===!1?["Invalid data"]:Array.isArray(e)?e.length===0?[]:e:[e]}const nt=()=>!0;function st(e){var t;return((t=e.error)==null?void 0:t.errorType)===ke}let de=null;function ot(){const e=de;return de=null,e}function it(e){const t=b(e.shortName+".internalCall"),r=ze.compute({fn:a=>{const s=a.handler,i=ct(s,t);return a.handler=i,a}});return lt(e).seq.splice(1,0,r),t}function ct(e,t){function r(...a){const{result:s,abortCallback:i}=pt(e,...a);if(s instanceof Promise){const o=We(),c=me(o,i);return t(c),s.then(o.resolve,o.reject),o.promise}else{const o=me(void 0,i);return t(o),s}}return r}function me(e,t){let r=e?"pending":"finished";function a(){r="finished",s.status=r}e&&e.promise.then(a,a);const s={id:ft(),status:r,abort:(i=Ze())=>{t==null||t(),r!=="finished"&&e&&e.reject(i)},promise:e==null?void 0:e.promise};return s}function lt(e){return e.graphite.scope.runner}let ut=0;function ft(){return`${ut++}`}function pt(e,...t){dt();const r=e(...t),a=ot();return{result:r,abortCallback:a}}const dt=b();function mt(e,{clock:t}){f({clock:t,source:ht(e),target:Ee})}function ht(e){if(!e.__.meta.$callObjects){const t=T([],{serialize:"ignore"});f({clock:e.__.lowLevelAPI.callObjectCreated,source:t,fn:(r,a)=>r.filter(s=>s.status==="pending").concat(a),target:t}),f({clock:Ee.done,source:t,fn:(r,{params:a})=>r.filter(s=>!a.includes(s)),target:t}),e.__.meta.$callObjects=t}return e.__.meta.$callObjects}const Ee=E(e=>e.forEach(t=>t.abort()));function ve({name:e,meta:t,kind:r,serialize:a,enabled:s,contract:i,validate:o,mapData:c,sourced:h,paramsAreMeaningless:$}){const n=b(),u=b(),k=b(),d=b(),p=rt(i),m=e??"unnamed",g=E({handler:()=>{throw new Error("Not implemented")},sid:`ff.${m}.executeFx`,name:`${m}.executeFx`}),_=it(g),P=[{name:"remote_source",get:E(async({params:l})=>({result:await g(l),stale:!1}))}],{retrieveDataFx:v,notifyAboutNewValidDataFx:x,notifyAboutDataInvalidationFx:j}=yt(P),D=b(),z=b(),R=b();f({clock:D,fn:l=>({params:l,meta:{stopErrorPropagation:!1,stale:!0}}),target:d});const A={success:b(),failure:b(),skip:b(),finally:b()},F=b(),q=b(),M=b();J({source:F,match:{aborted:({error:l})=>st({error:l})},cases:{aborted:M,__:A.failure}});const I=T("initial",{sid:`ff.${m}.$status`,name:`ff.${m}.$status`,serialize:a});f({clock:z,target:I.reinit});const G=T([],{serialize:"ignore",name:`ff.${m}.$statusHistory`,sid:`ff.${m}.$statusHistory`});f({clock:I.updates,source:G,fn:(l,y)=>[...l,y],target:G});const C=ae(s??!0).map(Boolean),se=T(void 0,{serialize:"ignore",name:`ff.${m}.$latestParams`,sid:`ff.${m}.$latestParams`,skipVoid:!1}),Ce=I.map(l=>l==="initial"),Oe=I.map(l=>l==="pending"),Le=I.map(l=>l==="fail"),xe=I.map(l=>l==="done"),Ne=I.map(l=>["fail","done"].includes(l));f({clock:[v.map(()=>"pending"),A.success.map(()=>"done"),A.failure.map(()=>"fail"),f({clock:M,source:{history:G,retrieveDataPengind:v.pending},fn:({history:l,retrieveDataPengind:y})=>y?"pending":l[l.length-2]??"initial"})],target:I}),f({clock:d,filter:C,fn:({params:l})=>l,target:se}),f({clock:D,filter:Z(C),fn(l){return{params:l,meta:{stopErrorPropagation:!1,stale:!1}}},target:A.skip}),f({clock:n,fn:({params:l})=>({params:l,meta:{stopErrorPropagation:!1,stale:!0}}),target:j}),f({clock:j.finally,source:n,filter:({refresh:l})=>l,fn:({params:l})=>({params:l,meta:{stopErrorPropagation:!1,stale:!0}}),target:d}),f({clock:d,filter:C,target:v}),f({clock:v,target:R}),f({clock:v.done,fn:({params:l,result:y})=>({params:l.params,result:y.result,meta:{stopErrorPropagation:y.stopErrorPropagation??!1,stale:y.stale}}),filter:C,target:p}),f({clock:v.fail,source:C,filter:(l,{error:y})=>l&&!y.stopErrorPropagation,fn:(l,{error:y,params:S})=>({error:y.error,params:S.params,meta:{stopErrorPropagation:y.stopErrorPropagation,stale:!1}}),target:F});const{validDataRecieved:oe,__:ie}=J(f({clock:p.done,source:{partialValidator:H({field:o??nt})},fn:({partialValidator:l},{params:{params:y,meta:S},result:O})=>({result:O,params:y,validation:l({result:O,params:y}),meta:S})}),{validDataRecieved:({validation:l})=>at(l)});f({clock:oe,source:{partialMapper:H({field:c})},fn:({partialMapper:l},{params:y,result:S,meta:O})=>({result:l({params:y,result:S}),params:y,meta:O}),target:A.success}),f({clock:A.success,filter:({meta:l})=>l.stale,fn:({params:l,meta:y})=>({params:l,meta:y,skipStale:!0}),target:v}),f({clock:oe,filter:({meta:l})=>!l.stale,target:x}),f({clock:p.fail,filter:({params:l})=>!l.meta.stopErrorPropagation,fn:({error:l,params:y})=>({error:l,params:y.params,meta:y.meta}),target:F}),f({clock:p.fail,fn:({error:l,params:y})=>({error:l,params:y.params,meta:y.meta}),target:q}),f({clock:ie,filter:({meta:l})=>!l.stopErrorPropagation,fn:({params:l,validation:y,meta:S,result:O})=>({params:l,error:te({validationErrors:pe(y),response:O}),meta:S}),target:F}),f({clock:ie,fn:({params:l,validation:y,meta:S,result:O})=>({params:l,error:te({validationErrors:pe(y),response:O}),meta:S}),target:q}),f({clock:C.updates,source:D,filter:Z(C),fn:l=>({params:l,meta:{stopErrorPropagation:!1,stale:!0}}),target:A.skip}),f({clock:A.success,fn:({params:l,result:y,meta:S})=>({status:"done",params:l,result:y,meta:S}),target:A.finally}),f({clock:A.failure,fn:({params:l,error:y,meta:S})=>({status:"fail",params:l,error:y,meta:S}),target:A.finally}),f({clock:A.skip,fn:({params:l,meta:y})=>({status:"skip",params:l,meta:y}),target:A.finally});const ce={start:D,finished:A,started:R,aborted:M,reset:z,$status:I,$idle:Ce,$pending:Oe,$failed:Le,$succeeded:xe,$finished:Ne,$enabled:C,__:{executeFx:g,meta:{...t,name:m,flags:{}},kind:r,$latestParams:w(se),lowLevelAPI:{dataSources:P,dataSourceRetrieverFx:v,sourced:h??[],paramsAreMeaningless:$??!1,revalidate:n,pushError:k,pushData:u,startWithMeta:d,callObjectCreated:_,failedIgnoreSuppression:q}}};return mt(ce,{clock:z}),ce}function yt(e){const t=E({handler:async({params:s,skipStale:i})=>{for(const o of e)try{const c=await o.get({params:s});if(i&&c!=null&&c.stale)continue;if(c)return c}catch(c){throw{stopErrorPropagation:!1,error:c}}throw{stopErrorPropagation:!1,error:new Error("No data source returned data")}}}),r=E({handler:async({params:s,result:i})=>{await Promise.all(e.map(fe("set")).filter(Boolean).map(o=>o({params:s,result:i})))}}),a=E({handler:async({params:s})=>{await Promise.all(e.map(fe("unset")).filter(Boolean).map(i=>i({params:s})))}});return{retrieveDataFx:t,notifyAboutNewValidDataFx:r,notifyAboutDataInvalidationFx:a}}const gt=Symbol("Query"),$t=Symbol("Farfetched node meta"),wt=Symbol("Farfetched links meta");function _t(e,t){return we({meta:{[$t]:e,[wt]:t},regional:!0})}function Ae(e){const{initialData:t,contract:r,mapData:a,enabled:s,validate:i,name:o,serialize:c,sourced:h,paramsAreMeaningless:$}=e,n=t??null,u=ve({name:o??be(),kind:gt,serialize:X(c),enabled:s,meta:{serialize:c,initialData:n,sid:bt(T(null,{sid:"dummy"}))},contract:r,validate:i,mapData:a,sourced:h,paramsAreMeaningless:$}),k=b(),d=T(n,{sid:`ff.${u.__.meta.name}.$data`,name:`${u.__.meta.name}.$data`,serialize:c,skipVoid:!1}),p=T(null,{sid:`ff.${u.__.meta.name}.$error`,name:`${u.__.meta.name}.$error`,serialize:X(c),skipVoid:!1}),m=T(!0,{sid:`ff.${u.__.meta.name}.$stale`,name:`${u.__.meta.name}.$stale`,serialize:X(c),skipVoid:!1});f({clock:u.finished.success,fn:()=>null,target:p}),f({clock:u.finished.success,fn:({result:R})=>R,target:d}),d.reset(u.finished.failure),f({clock:u.finished.failure,fn:({error:R})=>R,target:p}),f({clock:u.finished.finally,fn:({meta:R})=>R.stale,target:m}),f({clock:u.__.lowLevelAPI.pushData,target:[d,p.reinit]}),f({clock:u.__.lowLevelAPI.pushError,target:[p,d.reinit]});const g=Be({clock:k,until:u.$enabled}),_=b(),{haveToStart:P,__:v}=J(f({clock:g,source:{stale:m,latestParams:u.__.$latestParams},fn:({stale:R,latestParams:A},F)=>({haveToStart:R||!ee(F,A),params:F})}),{haveToStart:({haveToStart:R})=>R});f({clock:v,fn:()=>null,target:_}),f({clock:P,fn:({params:R})=>R,target:u.start}),f({clock:u.reset,target:[d.reinit,p.reinit,m.reinit]});const x={data:d,error:p,stale:m,pending:u.$pending,start:u.start},j=()=>x,D=({source:R,mapParams:A})=>{const F=Ae(e);return F.__.lowLevelAPI.dataSourceRetrieverFx.use(L({source:R,mapParams:({params:q,...M},I)=>({params:A?A(q,I):q,...M}),effect:u.__.lowLevelAPI.dataSourceRetrieverFx})),F},z=_t({type:"query",name:e.name},{$status:u.$status,$data:d,$error:p});return qe(z,()=>({refresh:k,start:u.start,reset:u.reset,started:w(u.started),$data:w(d),$error:w(p),$status:w(u.$status),$idle:w(u.$idle),$pending:w(u.$pending),$succeeded:w(u.$succeeded),$failed:w(u.$failed),$finished:w(u.$finished),$enabled:w(u.$enabled),$stale:m,aborted:w(u.aborted),finished:{success:w(u.finished.success),failure:w(u.finished.failure),finally:w(u.finished.finally),skip:w(u.finished.skip)},__:{...u.__,lowLevelAPI:{...u.__.lowLevelAPI,refreshSkipDueToFreshness:_},experimentalAPI:{attach:D}},"@@unitShape":j}))}function bt(e){const t=e.sid;return t!=null&&t.includes("|")?t:null}function Pe(e){const t=e;if(U.effect(t.effect))return t.effect;if(typeof t.handler=="function")return E(t.handler);throw new kt("handler or effect must be passed to the config")}class kt extends Error{constructor(t){super(t)}}function Nr(e){const t=Ae({initialData:e.initialData??null,contract:e.contract??_e,mapData:e.mapData??(({result:r})=>r),enabled:e.enabled,validate:e.validate,name:e.name,serialize:e.serialize});return t.__.executeFx.use(Pe(e)),t}const Et=E({sid:"ff.fetchFx",handler:globalThis.fetch});E({handler:async e=>{const t=await Et(e).catch(r=>{throw tt({reason:(r==null?void 0:r.message)??null,cause:r})});if(!t.ok)throw et({status:t.status,statusText:t.statusText,response:await t.text().catch(()=>null)??null});return t},sid:"ff.requestFx"});const vt=Symbol("Mutation");function Te(e){const{name:t,enabled:r,contract:a,validate:s,mapData:i}=e,o=ve({name:t??be(),serialize:"ignore",enabled:r,kind:vt,meta:null,contract:a,validate:s,mapData:i}),c={pending:o.$pending,start:o.start,reset:o.reset},h=()=>c,$=({source:n,mapParams:u})=>{const k=Te(e);return k.__.lowLevelAPI.dataSourceRetrieverFx.use(L({source:n,mapParams:({params:d,...p},m)=>({params:u?u(d,m):d,...p}),effect:o.__.lowLevelAPI.dataSourceRetrieverFx})),k};return{start:o.start,reset:o.reset,started:w(o.started),aborted:w(o.aborted),$status:w(o.$status),$idle:w(o.$idle),$pending:w(o.$pending),$succeeded:w(o.$succeeded),$failed:w(o.$failed),$finished:w(o.$finished),$enabled:w(o.$enabled),finished:{success:w(o.finished.success),failure:w(o.finished.failure),finally:w(o.finished.finally),skip:w(o.finished.skip)},__:{...o.__,experimentalAPI:{attach:$}},"@@unitShape":h}}function qr(e){const t=Te({name:e.name,enabled:e.enabled,contract:e.contract??_e,mapData:({result:r})=>r});return t.__.executeFx.use(Pe(e)),t}const At=["ms","milli","millisecond","milliseconds"],Pt=["s","sec","secs","second","seconds"],Tt=["m","min","mins","minute","minutes"],Rt=["h","hr","hrs","hour","hours"];function W(e){if(typeof e=="number")return e;let t=0;for(const r of e.split(" "))switch(!0){case Q(r,At):t+=V(r);break;case Q(r,Pt):t+=V(r)*1e3;break;case Q(r,Tt):t+=V(r)*6e4;break;case Q(r,Rt):t+=V(r)*36e5;break}return t}function Q(e,t){return t.includes(St(e))}function St(e){return e.replace(/[0-9.]/g,"")}function V(e){return e.includes(".")?parseFloat(e):parseInt(e)}function zr(e,{times:t,delay:r,filter:a,mapParams:s,...i}){const o=i.supressIntermediateErrors??!0,c=ae(t),h=T(1,{serialize:"ignore",name:"ff.$attempt",sid:"ff.$attempt"}),$=N({attempt:h}),n=N(h,c,(g,_)=>o&&g<=_),u=b(),k=b(),d=H({field:a??!0}),{planNextAttempt:p,__:m}=J(f({clock:u,source:{maxAttempts:c,attempt:h,partialFilter:d},filter:({partialFilter:g},_)=>g(_),fn:({attempt:g,maxAttempts:_},{params:P,error:v,meta:x})=>({params:P,error:v,meta:{...x,attempt:g,maxAttempts:_}})}),{planNextAttempt:({meta:g})=>g.attempt<=g.maxAttempts});if(f({clock:He({clock:f({clock:p,source:{partialMapper:H({field:s??(({params:g})=>g)})},fn:({partialMapper:g},_)=>g(_)}),timeout:N({partialTimeout:H({field:r}),meta:$},({partialTimeout:g,meta:_})=>W(g(_)))}),fn:g=>({params:g,meta:{stopErrorPropagation:!1,stale:!0}}),target:[k,e.__.lowLevelAPI.startWithMeta]}),h.on(k,g=>g+1).reset([e.finished.success,e.start]),i.otherwise&&f({clock:m,target:i.otherwise}),o){const g=e.__.lowLevelAPI.dataSourceRetrieverFx.use.getCurrent();f({clock:e.__.lowLevelAPI.failedIgnoreSuppression,target:u}),e.__.lowLevelAPI.dataSourceRetrieverFx.use(L({source:{supressError:n,partialFilter:d},mapParams:(_,{supressError:P,partialFilter:v})=>({..._,supressError:P,partialFilter:v}),effect:E(async({supressError:_,partialFilter:P,...v})=>{const x=$e(u,{safe:!0});try{return{...await g(v),stopErrorPropagation:_}}catch(j){const D={params:v.params,error:j.error,meta:v.meta};throw P(D)&&_?(x(D),{error:j.error,stopErrorPropagation:!0}):j}})}))}f({clock:e.finished.failure,target:u})}function It(e){const t=T(e,{serialize:"ignore",name:"ff.$cacheInstance",sid:"ff.$cacheInstance"});return{...e,__:{$instance:t}}}function Ft({adapter:e,options:t,events:r}){t!=null&&t.hit&&f({clock:e.get.done,filter:({result:a})=>a!==null,fn:({params:a})=>({key:a.key}),target:t.hit}),t!=null&&t.miss&&f({clock:e.get.done,filter:({result:a})=>a===null,fn:({params:a})=>({key:a.key}),target:t.miss}),t!=null&&t.expired&&r!=null&&r.itemExpired&&f({clock:r.itemExpired,fn:({key:a})=>({key:a}),target:t.expired}),t!=null&&t.evicted&&r!=null&&r.itemEvicted&&f({clock:r.itemEvicted,target:t.evicted})}function Dt(e){const{maxEntries:t,maxAge:r,observability:a}={};let s={};const i=b(),o=b(),c=b(),h=b(),$=b();$.watch(()=>{s={}});const n=Je({clock:i}),u=f({clock:i,source:{now:n},fn:({now:d},{key:p,value:m})=>jt(s,{key:p,entry:{value:m,cachedAt:d}},t)});if(u.watch(({next:d})=>{s=d}),f({clock:u,filter:({evicted:d})=>!!d,fn:({evicted:d})=>({key:d}),target:h}),o.watch(({key:d})=>{const{[d]:p,...m}=s;s=m}),r){const d=W(r);i.watch(p=>{const m=$e(c,{safe:!0});setTimeout(()=>m(p),d)}),f({clock:c,fn:({key:p})=>({key:p}),target:o})}const k={get:E(({key:d})=>{const p=s[d]??null;if(!p)return null;if(r){const m=(p==null?void 0:p.cachedAt)+W(r);if(Date.now()>=m)return o({key:d}),null}return p}),set:E(i),unset:E(o),purge:$};return Ft({adapter:k,options:a,events:{itemExpired:c,itemEvicted:h}}),It(k)}function jt(e,{key:t,entry:r},a){if(a===void 0)return{next:{...e,[t]:r},evicted:null};const s=Object.keys(e);if(s.length<a)return{next:{...e,[t]:r},evicted:null};const[i]=s,{[i]:o,...c}=e;return{next:{...c,[t]:r},evicted:i}}function Ct(e){let t=0,r=0;for(;r<e.length;)t=(t<<5)-t+e.charCodeAt(r++)|0;return t.toString(36)}function Re(e){const t=new Set;function r(a){if(a===void 0)return;if(a===null)return"null";if(typeof a=="number")return isFinite(a)?`${a}`:"null";if(typeof a=="function")throw new TypeError("Can't serialize function");if(typeof a!="object")return JSON.stringify(a);if(t.has(a))throw new TypeError("Can't serialize cyclic structure");if(t.add(a),Array.isArray(a)){const i=a.map(o=>r(o)||"null").join(",");return t.delete(a),`[${i}]`}const s=Object.keys(a).sort().map(i=>{const o=r(a[i]);return o?`${r(i)}:${o}`:""}).filter(Boolean).join(",");return t.delete(a),`{${s}}`}return r(e)}function Ot({sid:e,params:t=null,sources:r}){try{return Re({params:t,sources:r,sid:e})??null}catch{return null}}function Lt({sid:e,params:t=null,sources:r}){try{const a=Re({params:t,sources:r,sid:e});return Ct(a)}catch{return null}}function xt(e){const t=Nt(e);if(t)return t;const r=qt(e);if(r)return r;throw new Error("Query does not have sid or uniq name, which is required for caching, read more https://effector.dev/en/explanation/sids/")}function Nt(e){return e.__.meta.sid??null}const he=new Set;function qt(e){const t=e.__.meta.name;return he.has(t)?null:(he.add(t),t)}function Mr(e,t){const{adapter:r,staleAfter:a,purge:s,humanReadableKeys:i}={adapter:Dt(),humanReadableKeys:!1,...t},o=i?Ot:Lt,c=xt(e),h=e.__.lowLevelAPI.sourced.map(Me),$=E(async p=>Promise.all(h.map(m=>m(p)))),n=E(async({instance:p,params:m})=>{const g=await $(m),_=o({sid:c,params:e.__.lowLevelAPI.paramsAreMeaningless?null:m,sources:g});_&&await p.unset({key:_})}),u=E(async({instance:p,params:m,result:g})=>{const _=await $(m),P=o({sid:c,params:e.__.lowLevelAPI.paramsAreMeaningless?null:m,sources:_});P&&await p.set({key:P,value:g})}),k=E(async({params:p,instance:m})=>{const g=await $(p),_=o({sid:c,params:e.__.lowLevelAPI.paramsAreMeaningless?null:p,sources:g});if(!_)return null;const P=await m.get({key:_});if(!P)return null;const v=a?P.cachedAt+W(a)<=Date.now():!0;return{result:P.value,stale:v}}),d={name:"cache",get:L({source:{instance:r.__.$instance},mapParams:({params:p},{instance:m})=>({params:p,instance:m}),effect:k}),set:L({source:{instance:r.__.$instance},mapParams:({params:p,result:m},{instance:g})=>({params:p,result:m,instance:g}),effect:u}),unset:L({source:{instance:r.__.$instance},mapParams:({params:p},{instance:m})=>({instance:m,params:p}),effect:n})};e.__.lowLevelAPI.dataSources.unshift(d),s&&f({clock:s,source:{instance:r.__.$instance},target:E(({instance:p})=>p.purge())})}const zt=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Mt=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Ht=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ut(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Qt(e);return}return t}function Qt(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function Vt(e,t={}){if(typeof e!="string")return e;const r=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return r.slice(1,-1);if(r.length<=9){const a=r.toLowerCase();if(a==="true")return!0;if(a==="false")return!1;if(a==="undefined")return;if(a==="null")return null;if(a==="nan")return Number.NaN;if(a==="infinity")return Number.POSITIVE_INFINITY;if(a==="-infinity")return Number.NEGATIVE_INFINITY}if(!Ht.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(zt.test(e)||Mt.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,Ut)}return JSON.parse(e)}catch(a){if(t.strict)throw a;return e}}const Bt=/#/g,Jt=/&/g,Wt=/\//g,Kt=/=/g,ne=/\+/g,Gt=/%5e/gi,Xt=/%60/gi,Yt=/%7c/gi,Zt=/%20/gi;function er(e){return encodeURI(""+e).replace(Yt,"|")}function re(e){return er(typeof e=="string"?e:JSON.stringify(e)).replace(ne,"%2B").replace(Zt,"+").replace(Bt,"%23").replace(Jt,"%26").replace(Xt,"`").replace(Gt,"^").replace(Wt,"%2F")}function Y(e){return re(e).replace(Kt,"%3D")}function Se(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function tr(e){return Se(e.replace(ne," "))}function rr(e){return Se(e.replace(ne," "))}function ar(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const r of e.split("&")){const a=r.match(/([^=]+)=?(.*)/)||[];if(a.length<2)continue;const s=tr(a[1]);if(s==="__proto__"||s==="constructor")continue;const i=rr(a[2]||"");t[s]===void 0?t[s]=i:Array.isArray(t[s])?t[s].push(i):t[s]=[t[s],i]}return t}function nr(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(r=>`${Y(e)}=${re(r)}`).join("&"):`${Y(e)}=${re(t)}`:Y(e)}function sr(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>nr(t,e[t])).filter(Boolean).join("&")}const or=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,ir=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,cr=/^([/\\]\s*){2,}[^/\\]/,lr=/^\.?\//;function Ie(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?or.test(e):ir.test(e)||(t.acceptRelative?cr.test(e):!1)}function ur(e="",t){return e.endsWith("/")}function fr(e="",t){return(ur(e)?e.slice(0,-1):e)||"/"}function pr(e="",t){return e.endsWith("/")?e:e+"/"}function dr(e,t){if(hr(t)||Ie(e))return e;const r=fr(t);return e.startsWith(r)?e:gr(r,e)}function mr(e,t){const r=$r(e),a={...ar(r.search),...t};return r.search=sr(a),wr(r)}function hr(e){return!e||e==="/"}function yr(e){return e&&e!=="/"}function gr(e,...t){let r=e||"";for(const a of t.filter(s=>yr(s)))if(r){const s=a.replace(lr,"");r=pr(r)+s}else r=a;return r}const Fe=Symbol.for("ufo:protocolRelative");function $r(e="",t){const r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,u,k=""]=r;return{protocol:u.toLowerCase(),pathname:k,href:u+k,auth:"",host:"",search:"",hash:""}}if(!Ie(e,{acceptRelative:!0}))return ye(e);const[,a="",s,i=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,o="",c=""]=i.match(/([^#/?]*)(.*)?/)||[];a==="file:"&&(c=c.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:h,search:$,hash:n}=ye(c);return{protocol:a.toLowerCase(),auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:o,pathname:h,search:$,hash:n,[Fe]:!a}}function ye(e=""){const[t="",r="",a=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:a}}function wr(e){const t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",a=e.hash||"",s=e.auth?e.auth+"@":"",i=e.host||"";return(e.protocol||e[Fe]?(e.protocol||"")+"//":"")+s+i+t+r+a}class _r extends Error{constructor(t,r){super(t,r),this.name="FetchError",r!=null&&r.cause&&!this.cause&&(this.cause=r.cause)}}function br(e){var h,$,n,u,k;const t=((h=e.error)==null?void 0:h.message)||(($=e.error)==null?void 0:$.toString())||"",r=((n=e.request)==null?void 0:n.method)||((u=e.options)==null?void 0:u.method)||"GET",a=((k=e.request)==null?void 0:k.url)||String(e.request)||"/",s=`[${r}] ${JSON.stringify(a)}`,i=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",o=`${s}: ${i}${t?` ${t}`:""}`,c=new _r(o,e.error?{cause:e.error}:void 0);for(const d of["request","options","response"])Object.defineProperty(c,d,{get(){return e[d]}});for(const[d,p]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(c,d,{get(){return e.response&&e.response[p]}});return c}const kr=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function ge(e="GET"){return kr.has(e.toUpperCase())}function Er(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const vr=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Ar=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Pr(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return Ar.test(t)?"json":vr.has(t)||t.startsWith("text/")?"text":"blob"}function Tr(e,t,r,a){const s=Rr((t==null?void 0:t.headers)??(e==null?void 0:e.headers),r==null?void 0:r.headers,a);let i;return(r!=null&&r.query||r!=null&&r.params||t!=null&&t.params||t!=null&&t.query)&&(i={...r==null?void 0:r.params,...r==null?void 0:r.query,...t==null?void 0:t.params,...t==null?void 0:t.query}),{...r,...t,query:i,params:i,headers:s}}function Rr(e,t,r){if(!t)return new r(e);const a=new r(t);if(e)for(const[s,i]of Symbol.iterator in e||Array.isArray(e)?e:new r(e))a.set(s,i);return a}async function B(e,t){if(t)if(Array.isArray(t))for(const r of t)await r(e);else await t(e)}const Sr=new Set([408,409,425,429,500,502,503,504]),Ir=new Set([101,204,205,304]);function De(e={}){const{fetch:t=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:a=globalThis.AbortController}=e;async function s(c){const h=c.error&&c.error.name==="AbortError"&&!c.options.timeout||!1;if(c.options.retry!==!1&&!h){let n;typeof c.options.retry=="number"?n=c.options.retry:n=ge(c.options.method)?0:1;const u=c.response&&c.response.status||500;if(n>0&&(Array.isArray(c.options.retryStatusCodes)?c.options.retryStatusCodes.includes(u):Sr.has(u))){const k=typeof c.options.retryDelay=="function"?c.options.retryDelay(c):c.options.retryDelay||0;return k>0&&await new Promise(d=>setTimeout(d,k)),i(c.request,{...c.options,retry:n-1})}}const $=br(c);throw Error.captureStackTrace&&Error.captureStackTrace($,i),$}const i=async function(h,$={}){const n={request:h,options:Tr(h,$,e.defaults,r),response:void 0,error:void 0};n.options.method&&(n.options.method=n.options.method.toUpperCase()),n.options.onRequest&&await B(n,n.options.onRequest),typeof n.request=="string"&&(n.options.baseURL&&(n.request=dr(n.request,n.options.baseURL)),n.options.query&&(n.request=mr(n.request,n.options.query),delete n.options.query),"query"in n.options&&delete n.options.query,"params"in n.options&&delete n.options.params),n.options.body&&ge(n.options.method)&&(Er(n.options.body)?(n.options.body=typeof n.options.body=="string"?n.options.body:JSON.stringify(n.options.body),n.options.headers=new r(n.options.headers||{}),n.options.headers.has("content-type")||n.options.headers.set("content-type","application/json"),n.options.headers.has("accept")||n.options.headers.set("accept","application/json")):("pipeTo"in n.options.body&&typeof n.options.body.pipeTo=="function"||typeof n.options.body.pipe=="function")&&("duplex"in n.options||(n.options.duplex="half")));let u;if(!n.options.signal&&n.options.timeout){const d=new a;u=setTimeout(()=>{const p=new Error("[TimeoutError]: The operation was aborted due to timeout");p.name="TimeoutError",p.code=23,d.abort(p)},n.options.timeout),n.options.signal=d.signal}try{n.response=await t(n.request,n.options)}catch(d){return n.error=d,n.options.onRequestError&&await B(n,n.options.onRequestError),await s(n)}finally{u&&clearTimeout(u)}if((n.response.body||n.response._bodyInit)&&!Ir.has(n.response.status)&&n.options.method!=="HEAD"){const d=(n.options.parseResponse?"json":n.options.responseType)||Pr(n.response.headers.get("content-type")||"");switch(d){case"json":{const p=await n.response.text(),m=n.options.parseResponse||Vt;n.response._data=m(p);break}case"stream":{n.response._data=n.response.body||n.response._bodyInit;break}default:n.response._data=await n.response[d]()}}return n.options.onResponse&&await B(n,n.options.onResponse),!n.options.ignoreResponseError&&n.response.status>=400&&n.response.status<600?(n.options.onResponseError&&await B(n,n.options.onResponseError),await s(n)):n.response},o=async function(h,$){return(await i(h,$))._data};return o.raw=i,o.native=(...c)=>t(...c),o.create=(c={},h={})=>De({...e,...h,defaults:{...e.defaults,...h.defaults,...c}}),o}const K=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),Fr=K.fetch?(...e)=>K.fetch(...e):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Dr=K.Headers,jr=K.AbortController,Cr=De({fetch:Fr,Headers:Dr,AbortController:jr});function Or(e,t){return typeof e=="function"?e(t):e}const Lr=({baseURL:e,headers:t,payload:r,withTokenInHeaders:a})=>E(s=>{var h;const{url:i,...o}=Or(r,s),c=new Headers(t);return a&&c.append("Authorization",`Token ${(h=localStorage.getItem("$uuid"))==null?void 0:h.replaceAll('"',"")}`),Cr(i,{...o,headers:c,baseURL:e})},{name:"createRequestInstance",sid:"-2cl3s"}),je=e=>t=>Lr({...e,payload:t}),Hr=je({baseURL:"https://api.dev.cognitivelab.ru",withTokenInHeaders:!0}),Ur=je({baseURL:"https://api.dev.cognitivelab.ru"}),Qr={POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE",GET:"GET"};export{Qr as H,Nr as I,Mr as M,zr as R,Ur as a,Hr as c,qr as j};
